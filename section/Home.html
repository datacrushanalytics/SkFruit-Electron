<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title></title>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
    }

    .hero-section {
      flex: 1;
      display: flex;
    }

    /* Styles for the header */
    h3 {
      cursor: pointer;
      display: flex;
      align-items: center;
      font-size: 24px;
      color: #fff;
      margin-left: 33%;
    }

    h3 img {
      width: 13%;
      height: 13%;
      border-radius: 50%;
      margin-right: 5%;
    }

    #sidebar-container {
      width: 20%;
      background-color: #333;
      color: white;
      padding: 20px;
      z-index: 999;
      overflow-y: auto;
      height: 100vh;
    }

    #main-container {
      flex: 4;
      overflow: hidden;
      position: relative;
    }

    #iframe-container {
      position: relative;
      overflow: hidden;
      height: 100vh;
    }

    #pageContent {
      width: 100%;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
      border: none;
    }

    /* Hide scrollbar when not in use */
    .hide-scrollbar::-webkit-scrollbar {
      display: none;
    }

    .component {
      height: 35px;
      width: 100%;
      cursor: pointer;
      margin-bottom: 10px;
      color: #fff;
      background-color: #555;
      padding: 10px;
      border-radius: 5px;
      transition: background-color 0.3s ease;
    }

    .component.active {
      background-color: darkgray;
    }

    .component:hover {
      background-color: #777;
    }

    .logout {
      height: 35px;
      width: 100%;
      cursor: pointer;
      margin-top: 20px;
      color: #fff;
      background-color: #c0392b;
      padding: 10px;
      border: none;
      border-radius: 5px;
      transition: background-color 0.3s ease;
    }

    .logout:hover {
      background-color: #e74c3c;
    }

    @media (max-width: 768px) {
      /* Adjust as needed */
      #sidebar-container {
        width: auto;
        padding-bottom: 20px;
      }
    }
  </style>
</head>

<body>
  <div class="hero-section">
    <div id="main-container">
      <div id="iframe-container" class="hide-scrollbar"> <!-- Added container div -->
        <iframe id="pageContent" src="./Menu.html" frameborder="0"></iframe>
      </div>
    </div>
    <div id="sidebar-container">
      <h3 onclick="openPage('home')">
        <img src="../../assets/img/logo.png" alt="Company Logo">
        SK Fruit
      </h3>
      <!-- Add dynamic buttons here -->
      <!-- <a href="../section/Log_in.html"><button type="button" class="logout" onclick="login()">Log Out</button></a> -->
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Retrieve user data from localStorage
      var sessionData = JSON.parse(localStorage.getItem('sessionData'));
      var isAdmin = sessionData && sessionData[0].usertype === 'Admin';

      console.log(localStorage.getItem('sessionData'))
      console.log(sessionData[0].usertype)
      // Fetch data from API and dynamically generate buttons
      fetch("http://65.0.32.172/accessconfigData")
        .then(response => response.json())
        .then(data => {
          var sidebarContainer = document.getElementById('sidebar-container');

          data.forEach(menu => {
            if (isAdmin || menu.status === 'active') {
              var button = document.createElement('button');
              button.classList.add('component');
              button.textContent = menu.name;
              button.onclick = handleButtonClick; // Use the handleButtonClick function
              sidebarContainer.appendChild(button);
            }
          });

          // Add logout button at the bottom
          var logoutButton = document.createElement('button');
          logoutButton.href = "../section/Log_in.html";
          logoutButton.classList.add('logout');
          logoutButton.textContent = "Log Out";
          logoutButton.onclick = function() {
            localStorage.removeItem('sessionData');
            window.location.href = "../section/Log_in.html";
          };
          sidebarContainer.appendChild(logoutButton);
        })
        .catch(error => {
          console.error("Error fetching data:", error);
        });
    });

    function openPage(pageName) {
      var pageUrl;
      switch (pageName) {
        case 'home':
          pageUrl = './Menu.html';
          break;
        case 'user':
          pageUrl = "./user/user.html";
          break;
        case 'product':
          pageUrl = './product/product.html';
          break;
        case 'account':
          pageUrl = './account/account.html';
          break;
        case 'route':
          pageUrl = './route/Root_Details.html';
          break;
        case 'purchase':
          pageUrl = './purchase/Purchase.html'
          break;
        case 'sale3':
          pageUrl = './sale/sale3.html'
          break;
        case 'vehicle':
          pageUrl = './vehicle/Vehicle_Details.html'
          break;
        case 'barcode':
          pageUrl = './barcode/barcode.html'
          break;
        case 'receipt':
          pageUrl = './receipt/Receipt.html'
          break;
        case 'payment':
          pageUrl = './payment/Payment.html'
          break;
        case 'purchaseReport':
          pageUrl = '../report/purchaseReport/purchaseReport.html'
          break;
        case 'routewiseSaleReport':
          pageUrl = '../report/routewiseSaleReport/routewiseSaleReport.html'
          break;
        case 'stockReport':
          pageUrl = '../report/stockReport/stockReport.html'
          break;
        case 'batawiseSaleReport':
          pageUrl = '../report/batawiseSaleReport/batawiseSaleReport.html'
          break;
        case 'khatawani':
          pageUrl = '../report/khatawani/khatawani.html'
          break;
        case 'dailyReport':
          pageUrl = '../report/dailyReport/dailyReport.html'
          break;
        case 'receiptReport':
          pageUrl = '../report/receiptReport/receiptReport.html'
          break;
        case 'ledgerReport':
          pageUrl = '../report/ledgerReport/ledger.html'
          break;
        case 'customerOutstanding':
          pageUrl = '../report/customerOutstanding/customerOutstanding.html'
          break;
        case 'supplierOutstanding':
          pageUrl = '../report/supplierOutstanding/supplierOutstanding.html'
          break;
        case 'carateReport':
          pageUrl = '../report/carateReport/carateReport.html'
          break;
        case 'remainder':
          pageUrl = '../report/remainder/remainder.html'
          break;
        case 'profitLossReport':
          pageUrl = '../report/profitLossReport/profit_loss_report.html'
          break;
        default:
          pageUrl = './Home2.html';
      }
      document.getElementById('pageContent').src = pageUrl;
    }

    function handleButtonClick(event) {
      var buttons = document.querySelectorAll('.component');
      buttons.forEach(function(button) {
        button.classList.remove('active');
      });

      event.target.classList.add('active');

      var pageName = event.target.textContent;

      openPage(pageName);
    }

    // Function to show scrollbar when iframe content is being scrolled
    document.getElementById('iframe-container').addEventListener('scroll', function() {
      // Add class to show scrollbar
      this.classList.remove('hide-scrollbar');
    });

    // Function to hide scrollbar when iframe content is not being scrolled
    document.getElementById('iframe-container').addEventListener('mouseleave', function() {
      // Remove class to hide scrollbar
      this.classList.add('hide-scrollbar');
    });
  </script>
</body>

</html>
